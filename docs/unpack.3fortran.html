<html> 
<head> 
<title> </title>
<style> 
px {font-family: "Lucida Console", Monaco, monospace }
p { font-size:100%; line-height:1.1em; }
body {xfont-style: sans-serif}
body {
color:#333; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:1em; line-height:1.3em; }
a:visited { color:#666; }
h1,h2,h3,h4,h5,h6 { color:#333; font-family:georgia, verdana, sans-serif; }
h1 { font-size:150%; page-break-before:auto;background-color: #aaaaff}
h2 { font-size:143%;color:teal; }
h3 { font-size:134%;color:blue; }
h4 { font-size:120%;color:gray; }
img { max-width: 55em}
p{ padding: 0;margin:0; }
p{ padding-right:1.4em; }
p{ padding-bottom:0.1em; }
p{ padding-top:1em; }
p{ whitespace: pre-wrap; }
h5,h6 { font-size:100% }
a.nav,a:link.nav, a:visited.nav { background-color:#FFF; color:#000; }
XXtable { border:double #000; border-collapse:collapse; }
XXtable { border-collapse:collapse; }
XXtd { border:thin solid #888; }
XXtd { border:none; }
li { margin-bottom:0.5em; }
blockquote { display:block; font-size:100%; line-height:1.1em; margin:0 0 0.5em; padding:0 2.5em; }
pre { background-color:#DDD; font-size:100%; overflow:auto; padding:1em; }
a,li span { color:#000; }
a:hover, a.nav:hover, a:hover math { background-color:#000; color:#FFF; }
#Container { margin:0 10px; text-align:center; background-color: #BBB}
#Content { border-top:none; margin:auto; padding:0.3em; text-align:left; width:100%; max-width:55em; background:#FFF}
span.webName { font-size:.5em; }
textarea#content { font-size: 1em; line-height: 1.125; }
h1#pageName { line-height:1em; margin:0.2em 0 0.2em 0; padding:0; }
.property { color:#666; font-size:100%; }
a.existingWikiWord[title]{ //border: 1px dashed #BBB; }
.byline { color:#666; font-size:1.0em; font-style:italic; margin-bottom:1em; padding-top:1px; } 
</style> 
</head>
<BODY bgcolor=#F0F0F0 text=#000000 link=#0000ff vlink=#C000C0 alink=#ff0000><A NAME=top></A>
<!--
<h5><a href="index.html">[UP]</a></h5>
<button type="button" onclick="javascript:history.back()">Back</button>
-->
<div id="Container">
<div id="Content">
<CENTER>
<H1><HR><I>C Library Functions &nbsp;-&nbsp;</I><NOBR>unpack (3)</NOBR><HR></H1>
</CENTER>
<A name=0>

     <H3>NAME</H3>

</A>
<BLOCKQUOTE>
<P>
UNPACK(3) - [ARRAY:CONSTRUCTION] Scatter the elements of a vector into
an array using a mask
<P>
</BLOCKQUOTE>
<BLOCKQUOTE>
</BLOCKQUOTE>
<A name=9>

     <H3>SYNOPSIS</H3>

</A>
<BLOCKQUOTE>
<P>
result = unpack(vector, mask, field)
<P>
<PRE>
         type(TYPE(kind=KIND)) unpack(vector, mask, field)
<P>
          type(TYPE(kind=KIND)),intent(in) :: vector(:)
          logical,intent(in)               :: mask(..)
          type(TYPE(kind=KIND)),intent(in) :: field(..)
<P>
</PRE>
</BLOCKQUOTE>
<A name=2>

     <H3>CHARACTERISTICS</H3>

</A>
<BLOCKQUOTE>
<P>
<TABLE cellpadding=3>
<TR valign=top><TD width=3%>
o
</TD><TD>
VECTOR is a rank-one array of any type
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
MASK is a logical array
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
FIELD is the same type and type parameters as VECTOR conformable
with MASK.
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
The result is an array of the same type and type parameters as
VECTOR and the same shape as MASK.
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=3>

     <H3>DESCRIPTION</H3>

</A>
<BLOCKQUOTE>
<P>
UNPACK(3) scatters the elements of VECTOR into a copy of an array FIELD
of any rank using .true. values from MASK in array element order to
specify placement of the VECTOR values.
<P>
So a copy of FIELD is generated with select elements replaced with
values from VECTOR. This allows for complex replacement patterns that
would be difficult when using array syntax or multiple assignment
statements, particularly when the replacements are conditional.
</BLOCKQUOTE>
<A name=4>

     <H3>OPTIONS</H3>

</A>
<BLOCKQUOTE>
<P>
<TABLE cellpadding=3>
<TR valign=top><TD width=3%>
o
</TD><TD>
VECTOR : New values to place into specified locations in FIELD. It
shall have at least as many elements as MASK has .true. values.
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
MASK : Shall be an array that specifies which values in FIELD are to
be replaced with values from VECTOR.
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
FIELD : The input array to be altered.
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=5>

     <H3>RESULT</H3>

</A>
<BLOCKQUOTE>
<P>
The element of the result that corresponds to the ith true element of
MASK, in array element order, has the value VECTOR(I) for i = 1, 2, . .
[char46], t, where t is the number of true values in MASK. Each other element
has a value equal to *field if *field is scalar or to the corresponding
element of *field if it is an array.
<P>
The resulting array corresponds to FIELD with .true. elements of MASK
replaced by values from VECTOR in array element order.
</BLOCKQUOTE>
<A name=6>

     <H3>EXAMPLES</H3>

</A>
<BLOCKQUOTE>
<P>
Particular values may be "scattered" to particular positions in an array
by using
<BLOCKQUOTE>
<P>
1 0 0
</BLOCKQUOTE>
<TABLE cellpadding=3><!-- tsb: 1 0 0
 -->
<TR></TR><TR></TR>
<TR valign=top><TD colspan=2>
<B>If M is the array</B> </TD></TR><TR valign=top><TD width=6%>&nbsp;</TD><TD>
0 1 0
0 0 1
<P>
V is the array [1, 2, 3],
[char46] T .
<TABLE width=100% cellpadding=3><!-- tsb: V is the array [1, 2, 3],
 -->
<TR></TR><TR></TR>
<TR valign=top><TD colspan=2>
<B>and Q is the logical mask</B> </TD></TR><TR valign=top><TD width=6%>&nbsp;</TD><TD>
T . .
[char46] . T
where "T" represents true and "." represents false, then the result of
</TD></TR>
<TR><TD colspan=2>
UNPACK (V, MASK = Q, FIELD = M) has the value
</TD></TR>
<TR><TD width=6%>&nbsp;</TD><TD>
<P>
1 2 0
1 1 0
0 0 3
</TD></TR>
<TR><TD colspan=2>
and the result of UNPACK (V, MASK = Q, FIELD = 0) has the value
</TD></TR>
<TR><TD width=6%>&nbsp;</TD><TD>
<P>
0 2 0
1 0 0
0 0 3
</TD></TR>
<TR></TR></TABLE><!-- .PP -->
</TD></TR>
<TR></TR></TABLE>Sample program:
<P>
<PRE>
    program demo_unpack
    implicit none
    logical,parameter :: T=.true., F=.false.
<P>
    integer :: vector(2)  = [1,1]
<P>
    ! mask and field must conform
    integer,parameter :: r=2, c=2
    logical :: mask(r,c)  = reshape([ T,F,F,T ],[2,2])
    integer :: field(r,c) = 0, unity(2,2)
<P>
       ! basic usage
       unity = unpack( vector, mask, field )
       call print_matrix_int(&#146;unity=&#146;, unity)
<P>
       ! if FIELD is a scalar it is used to fill all the elements
       ! not assigned to by the vector and mask.
       call print_matrix_int(&#146;scalar field&#146;,         &
       & unpack(                                     &
       & vector=[ 1, 2, 3, 4 ],                      &
       & mask=reshape([ T,F,T,F,F,F,T,F,T ], [3,3]), &
       & field=0) )
<P>
    contains
<P>
    subroutine print_matrix_int(title,arr)
    ! convenience routine:
    ! just prints small integer arrays in row-column format
    implicit none
    character(len=*),intent(in)  :: title
    integer,intent(in)           :: arr(:,:)
    integer                      :: i
    character(len=:),allocatable :: biggest
<P>
       write(*,*)trim(title)
       ! make buffer to write integer into
       biggest=&#146;           &#146;
       ! find how many characters to use for integers
       write(biggest,&#146;(i0)&#146;)ceiling(log10(max(1.0,real(maxval(abs(arr))))))+2
       ! use this format to write a row
       biggest=&#146;("  [",*(i&#146;//trim(biggest)//&#146;:,","))&#146;
       ! print one row of array at a time
       do i=1,size(arr,dim=1)
          write(*,fmt=biggest,advance=&#146;no&#146;)arr(i,:)
          write(*,&#146;(" ]")&#146;)
       enddo
    end subroutine print_matrix_int
<P>
    end program demo_unpack
<P>
</PRE>
Results:
<P>
<PRE>
       &gt; unity=
       &gt;  [ 1, 0 ]
       &gt;  [ 0, 1 ]
       &gt; scalar field
       &gt;  [  1,  0,  3 ]
       &gt;  [  0,  0,  0 ]
       &gt;  [  2,  0,  4 ]
<P>
</PRE>
</BLOCKQUOTE>
<A name=7>

     <H3>STANDARD</H3>

</A>
<BLOCKQUOTE>
<P>
Fortran 95
</BLOCKQUOTE>
<A name=8>

     <H3>SEE ALSO</H3>

</A>
<BLOCKQUOTE>
<P>
MERGE(3), PACK(3), SPREAD(3)
<P>
fortran-lang intrinsic descriptions (license: MIT) @urbanjost
</BLOCKQUOTE>
<P><HR>
<TABLE width=100%><TR> <TD width=33%><I>Nemo Release 3.1</I></TD> <TD width=33% align=center>unpack (3)</TD> <TD align=right width=33%><I>September 01, 2024</I></TD> </TR></TABLE><FONT SIZE=-1>Generated by <A HREF="http://www.squarebox.co.uk/download/manServer.shtml">manServer 1.08</A> from b5c68e4f-bca9-442e-b4cf-86ada1b4b0a9 using man macros.</FONT>
<br><br><center><img src="images/unpack.3fortran.gif"></center>
</div>
</div>
</body>
</HTML>
