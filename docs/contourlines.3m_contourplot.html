<html> 
<head> 
<title> </title>
<style> 
px {font-family: "Lucida Console", Monaco }
p { font-size:100%; line-height:1.1em; }
body {xfont-style: sans-serif}
body {
color:#333; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:1em; line-height:1.3em; }
a:visited { color:#666; }
h1,h2,h3,h4,h5,h6 { color:#333; font-family:georgia, verdana, sans-serif; }
h1 { font-size:150%; page-break-before:auto;background-color: #aaaaff}
h2 { font-size:143%;color:teal; }
h3 { font-size:134%;color:blue; }
h4 { font-size:120%;color:gray; }
img { max-width: 55em}
p{ padding: 0;margin:0; }
p{ padding-right:1.4em; }
p{ padding-bottom:1em; }
p{ padding-top:1em; }
p{ whitespace: pre-wrap; }
h5,h6 { font-size:100% }
a.nav,a:link.nav, a:visited.nav { background-color:#FFF; color:#000; }
XXtable { border:double #000; border-collapse:collapse; }
XXtable { border-collapse:collapse; }
XXtd { border:thin solid #888; }
XXtd { border:none; }
li { margin-bottom:0.5em; }
blockquote { display:block; font-size:100%; line-height:1.1em; margin:0 0 1.5em; padding:0 2.5em; }
pre { background-color:#DDD; font-size:100%; overflow:auto; padding:1em; }
a,li span { color:#000; }
a:hover, a.nav:hover, a:hover math { background-color:#000; color:#FFF; }
#Container { margin:0 10px; text-align:center; background-color: #BBB}
#Content { border-top:none; margin:auto; padding:0.3em; text-align:left; width:100%; max-width:55em; background:#FFF}
span.webName { font-size:.5em; }
textarea#content { font-size: 1em; line-height: 1.125; }
h1#pageName { line-height:1em; margin:0.2em 0 0.2em 0; padding:0; }
.property { color:#666; font-size:100%; }
a.existingWikiWord[title]{ //border: 1px dashed #BBB; }
.byline { color:#666; font-size:1.0em; font-style:italic; margin-bottom:1em; padding-top:1px; } 
</style> 
</head>
<BODY bgcolor=#F0F0F0 text=#000000 link=#0000ff vlink=#C000C0 alink=#ff0000><A NAME=top></A>
<h5><a href="index.html">[UP]</a></h5>
<div id="Container">
<div id="Content">
<CENTER>
<H1><HR><I>Manual Reference Pages &nbsp;-&nbsp;</I><NOBR>contourlines (3)</NOBR><HR></H1>
</CENTER>
<A name=0>

     <H3>NAME</H3>

</A>
<BLOCKQUOTE>
<B>contourlines</B>(3f) - [M_contourplot] calculate contour lines from ungridded data <B>f</B>(x,y)
and call user-supplied routine with results
<P>
</BLOCKQUOTE>
<A name=contents></A><H3>CONTENTS</H3></A>
<BLOCKQUOTE>
<A HREF=#1>Synopsis</A><BR>
<A HREF=#2>Description</A><BR>
<A HREF=#3>Authors</A><BR>
<A HREF=#4>Comments</A><BR>
<A HREF=#5>Options</A><BR>
<A HREF=#6>Example</A><BR>
</BLOCKQUOTE>
<A name=7>

     <H3>SYNOPSIS</H3>

</A>
<BLOCKQUOTE>
SUBROUTINE <B>ContourLines</B>(x,y,z,ismopt,iexp,jexp,clist,epsilon,ierr,cntcrv)
<P>
<PRE>
      real,intent(in),dimension(:) :: x
      real,intent(in),dimension(:) :: y
      real,intent(in),dimension(:) :: z
      integer,intent(in)           :: ismopt
      integer,intent(in)           :: iexp
      integer,intent(in)           :: jexp
      real,intent(in),dimension(:) :: clist
      real,intent(out)             :: epsilon
      integer,intent(out)          :: ierr
      external cntcrv
<P>
</PRE>
</BLOCKQUOTE>
<A name=2>

     <H3>DESCRIPTION</H3>

</A>
<BLOCKQUOTE>
<P>
<B>contourlines</B>(3f) is a general algorithm for the construction of
contour plots. It computes contour lines of constant z for the
function z = <B>f</B>(x,y).
<P>
From the original COSMIC description:
<P>
The graphical presentation of experimentally or theoretically generated
data sets frequently involves the construction of contour plots. A
general computer algorithm has been developed for the construction
of contour plots. The algorithm provides for efficient and accurate
contouring with a modular approach which allows flexibility in modifying
the algorithm for special applications. The algorithm accepts as input
data values at a set of points irregularly distributed over a plane. The
algorithm is based on an interpolation scheme in which the points in
the plane are connected by straight line segments to form a set of
triangles. In general, the data is smoothed using a least-squares-error
fit of the data to a bivariate polynomial. To construct the contours,
interpolation along the edges of the triangles is performed, using the
bivariable polynomial if data smoothing was performed. Once the contour
points have been located, the contour may be drawn.
</BLOCKQUOTE>
<A name=3>

     <H3>AUTHORS</H3>

</A>
<BLOCKQUOTE>
<P>
This is a public domain routine from PDAS (Public Domain Aeronautical
Software) converted to modules; which was derived from COSMIC Program
Number ARC-11441; which originated at NASA Ames Research Center,
circa 1981.
</BLOCKQUOTE>
<A name=4>

     <H3>COMMENTS</H3>

</A>
<BLOCKQUOTE>
<P>
From the original PDAS description:
<P>
There are many additional algorithms available for computation of contour lines.
There are several in the Transactions for Mathematical Software and
elsewhere. This routine was deemed worthy of inclusion in the NASA COSMIC
collection, but I cannot swear to its status among contour generators.
</BLOCKQUOTE>
<A name=5>

     <H3>OPTIONS</H3>

</A>
<BLOCKQUOTE>
<TABLE cellpadding=3>
<TR valign=top><TD width=6% nowrap>
<B>x</B> </TD><TD valign=bottom>
input list of x values
</TD></TR>
<TR valign=top><TD width=6% nowrap>
<B>y</B> </TD><TD valign=bottom>
input list of y values
</TD></TR>
<TR valign=top><TD width=6% nowrap>
<B>z</B> </TD><TD valign=bottom>
input list of z values
</TD></TR>
<TR valign=top><TD width=6% nowrap>
<B>ismopt</B> </TD><TD valign=bottom>
smoothing option flag (0=no/off, 1=yes/on)
</TD></TR>
<TR valign=top><TD colspan=2>
<B>iexp,jexp</B> </TD></TR><TR valign=top><TD width=6%>&nbsp;</TD><TD>
i and j exponent value for smoothing
If smoothing is used, these values are used to define
a polynomial used for a least-squares fit of the data.
</TD></TR>
<TR valign=top><TD width=6% nowrap>
<B>clist</B> </TD><TD valign=bottom>
list of constant contour values
</TD></TR>
<TR valign=top><TD colspan=2>
<B>epsilon</B> </TD></TR><TR valign=top><TD width=6%>&nbsp;</TD><TD>
error function (normalized value) returned to caller
if ismopt is non-zero
</TD></TR>
<TR valign=top><TD width=6% nowrap>
<B>ierr</B> </TD><TD valign=bottom>
return error flag
<TABLE width=100% cellpadding=3><!-- tsb: return error flag
 -->
<TR></TR><TR></TR>
<TR valign=top><TD width=4%>
0.
</TD><TD>
for normal return
</TD></TR>
<TR valign=top><TD width=4%>
1.
</TD><TD>
for invalid value for number of values in x,y,z
</TD></TR>
<TR valign=top><TD width=4%>
2.
</TD><TD>
for number of ismopt coefficients greater
than &#146;maxcof&#146; or number of values in x,y,z
</TD></TR>
<TR></TR></TABLE></TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=6>

     <H3>EXAMPLE</H3>

</A>
<BLOCKQUOTE>
<P>
TEST1:
<P>
<PRE>
   ! program demo_contourlines and user routine
   program TestCase
   use M_ContourPlot, only : contourlines
   implicit none
   !
   integer,parameter    :: NPTS=121
   real,parameter,dimension(8):: c = &
         [0.1, 0.2, 0.5, 1.0, 2.0, 4.0, 6.0, 8.0]
   real                 :: eps
   integer              :: errCode
   integer,parameter    :: DBG=2
   integer              :: ierr
   !integer              :: iexp=0, jexp=0, ism=0
   integer              :: iexp=2, jexp=3, ism=1
   integer              :: i,j,k
   real,dimension(NPTS) :: x,y,z
   external             :: my_CntCrv
   !
      k=0
      do j=0,10
         do i=0,10
            k=k+1
            x(k)=0.1*real(i)
            y(k)=0.1*real(j)
         end do
      end do
      !
      z=(x-0.5)**2 + (y-0.5)**2
      z(:)=16.0*z(:)
      !
      ! write out the input values for inspection
      open(unit=dbg, file=&#146;test.log&#146;, status=&#146;replace&#146;, &
         & iostat=errCode, action=&#146;write&#146;, position=&#146;rewind&#146;)
      write(DBG,&#146;(I4,3F12.6)&#146;) (k,x(k),y(k),z(k),k=1,npts)
      !
      call ContourLines(x,y,z, ism,iexp,jexp, c, eps,ierr,my_CntCrv)
   END PROGRAM TestCase
   ! ----------------------------------------------------------------
   subroutine my_CntCrv(x,y,n,z)
   ! User-supplied routine used to plot or process the contour lines
   implicit none
   integer,intent(in)          :: n
   real,intent(in),dimension(n):: x,y
   real,intent(in)             :: z
   !
   integer,save                :: gnu=0
   integer                     :: k
   integer                     :: errCode
      if(gnu.eq.0)then
         ! on first call, set up output file
         gnu=1
         open(unit=gnu, file=&#146;test1.gnu&#146;, status=&#146;replace&#146;, &
           & iostat=errCode, action=&#146;write&#146;, position=&#146;rewind&#146;)
         write(*,*) "File test1.gnu added to your directory"
      endif
      ! write a contour line out to a file followed by a blank line
      write(gnu,&#146;("# level ",g0)&#146;) z
      write(gnu,&#146;(2f12.5)&#146;) (x(k),y(k),k=1,n)
      write(gnu,&#146;(a)&#146;) " "
   !
   end subroutine my_CntCrv
   ! end program demo_contourlines and user routine
<P>
   #!/bin/sh
   # Example execution of gnuplot(1) to plot the output file
   gnuplot &lt;&lt;\EOF
   plot &#146;test1.gnu&#146; with lines
   pause mouse "click mouse to exit &#46;&#46;&#46;"
   quit
</PRE>
</BLOCKQUOTE>
<A name=>

    <H4>&nbsp; &nbsp; EOF</H4>
</A>
<BLOCKQUOTE>
<P>
</BLOCKQUOTE>
<P><HR>
<TABLE width=100%><TR> <TD width=33%><I></I></TD> <TD width=33% align=center>contourlines (3)</TD> <TD align=right width=33%><I>June 05, 2021</I></TD> </TR></TABLE><FONT SIZE=-1>Generated by <A HREF="http://www.squarebox.co.uk/download/manServer.shtml">manServer 1.08</A> from 195ee346-3e7d-4f44-82a3-11b538e01dbf using man macros.</FONT>
<br><br><center><img src="images/contourlines.3m_contourplot.gif"></center>
</div>
</div>
</body>
</HTML>
