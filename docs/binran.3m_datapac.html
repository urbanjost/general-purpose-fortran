<html> 
<head> 
<title> </title>
<style> 
px {font-family: "Lucida Console", Monaco, monospace }
p { font-size:100%; line-height:1.1em; }
body {xfont-style: sans-serif}
body {
color:#333; font-family:Verdana, Arial, Helvetica, sans-serif; font-size:1em; line-height:1.3em; }
a:visited { color:#666; }
h1,h2,h3,h4,h5,h6 { color:#333; font-family:georgia, verdana, sans-serif; }
h1 { font-size:150%; page-break-before:auto;background-color: #aaaaff}
h2 { font-size:143%;color:teal; }
h3 { font-size:134%;color:blue; }
h4 { font-size:120%;color:gray; }
img { max-width: 55em}
p{ padding: 0;margin:0; }
p{ padding-right:1.4em; }
p{ padding-bottom:0.1em; }
p{ padding-top:1em; }
p{ whitespace: pre-wrap; }
h5,h6 { font-size:100% }
a.nav,a:link.nav, a:visited.nav { background-color:#FFF; color:#000; }
XXtable { border:double #000; border-collapse:collapse; }
XXtable { border-collapse:collapse; }
XXtd { border:thin solid #888; }
XXtd { border:none; }
li { margin-bottom:0.5em; }
blockquote { display:block; font-size:100%; line-height:1.1em; margin:0 0 0.5em; padding:0 2.5em; }
pre { background-color:#DDD; font-size:100%; overflow:auto; padding:1em; }
a,li span { color:#000; }
a:hover, a.nav:hover, a:hover math { background-color:#000; color:#FFF; }
#Container { margin:0 10px; text-align:center; background-color: #BBB}
#Content { border-top:none; margin:auto; padding:0.3em; text-align:left; width:100%; max-width:55em; background:#FFF}
span.webName { font-size:.5em; }
textarea#content { font-size: 1em; line-height: 1.125; }
h1#pageName { line-height:1em; margin:0.2em 0 0.2em 0; padding:0; }
.property { color:#666; font-size:100%; }
a.existingWikiWord[title]{ //border: 1px dashed #BBB; }
.byline { color:#666; font-size:1.0em; font-style:italic; margin-bottom:1em; padding-top:1px; } 
</style> 
</head>
<BODY bgcolor=#F0F0F0 text=#000000 link=#0000ff vlink=#C000C0 alink=#ff0000><A NAME=top></A>
<!--
<h5><a href="index.html">[UP]</a></h5>
<button type="button" onclick="javascript:history.back()">Back</button>
-->
<div id="Container">
<div id="Content">
<CENTER>
<H1><HR><I>C Library Functions &nbsp;-&nbsp;</I><NOBR>binran (3)</NOBR><HR></H1>
</CENTER>
<A name=0>

     <H3>NAME</H3>

</A>
<BLOCKQUOTE>
binran(3f) - [M_datapac:RANDOM] generate binomial random numbers
<P>
</BLOCKQUOTE>
<A name=contents></A><H3>CONTENTS</H3></A>
<BLOCKQUOTE>
<A HREF=#1>Synopsis</A><BR>
<A HREF=#2>Description</A><BR>
<A HREF=#3>Options</A><BR>
<A HREF=#4>Input Arguments</A><BR>
<A HREF=#5>Output Arguments</A><BR>
<A HREF=#6>Examples</A><BR>
<A HREF=#7>Author</A><BR>
<A HREF=#8>Maintainer</A><BR>
<A HREF=#9>License</A><BR>
<A HREF=#10>References</A><BR>
</BLOCKQUOTE>
<A name=11>

     <H3>SYNOPSIS</H3>

</A>
<BLOCKQUOTE>
SUBROUTINE BINRAN(N,P,Npar,Iseed,X)
<P>
<PRE>
       INTEGER,intent(in)        :: N
       REAL(kind=wp),intent(in)  :: P
       INTEGER,intent(in)        :: Npar
       INTEGER,intent(inout)     :: Iseed
       REAL(kind=wp),intent(out) :: X
<P>
</PRE>
</BLOCKQUOTE>
<A name=2>

     <H3>DESCRIPTION</H3>

</A>
<BLOCKQUOTE>
BINRAN(3f) generates a random sample of size N from the binomial
distribution with &#146;Bernoulli probability&#146; parameter =
P, and integer &#146;number of bernoulli trials&#146; parameter = NPAR.
<P>
The binomial distribution used herein has mean = NPAR*P and standard
deviation = sqrt(NPAR*P*(1-P)).
<P>
This distribution is defined for all discrete integer X between 0
(inclusively) and NPAR (inclusively). This distribution has the
probability function
<P>
<PRE>
       f(X) = c(NPAR,X) * P**X * (1-P)**(NPAR-X)
<P>
</PRE>
Where c(NPAR,X) is the combinatorial function equaling the number of
combinations of NPAR items taken X at a time.
<P>
The binomial distribution is the distribution of the number of
successes in NPAR Bernoulli (0,1) trials where the probability of
success in a precision trial = P.
</BLOCKQUOTE>
<A name=3>

     <H3>OPTIONS</H3>

</A>
<BLOCKQUOTE>
</BLOCKQUOTE>
<A name=4>

     <H3>INPUT ARGUMENTS</H3>

</A>
<BLOCKQUOTE>
<P>
<TABLE cellpadding=3>
<TR valign=top><TD width=6% nowrap>
<B>N</B> </TD><TD valign=bottom>
The desired integer number of random numbers to be generated.
</TD></TR>
<TR valign=top><TD width=6% nowrap>
<B>P</B> </TD><TD valign=bottom>
The value of the &#146;Bernoulli probability&#146; parameter for the
binomial distribution. P should be between 0.0 (exclusively)
and 1.0 (exclusively).
</TD></TR>
<TR valign=top><TD width=6% nowrap>
<B>ISEED</B> </TD><TD valign=bottom>
An integer iseed value. Should be set to a non-negative value
to start a new sequence of values. Will be set to <B>-1</B> on return
to indicate the next call should continue the current random
sequence walk.
</TD></TR>
<TR valign=top><TD width=6% nowrap>
<B>NPAR</B> </TD><TD valign=bottom>
The integer value of the &#146;number of Bernoulli trials&#146;
parameter. NPAR should be a positive integer.
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=5>

     <H3>OUTPUT ARGUMENTS</H3>

</A>
<BLOCKQUOTE>
<P>
<TABLE cellpadding=3>
<TR valign=top><TD width=6% nowrap>
<B>X</B> </TD><TD valign=bottom>
A vector (of dimension at least N) into which the generated
random sample of size N from the binomial distribution
will be placed; with &#146;Bernoulli probability&#146; parameter = P
and &#146;number of Bernoulli trials&#146; parameter = NPAR.
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<A name=6>

     <H3>EXAMPLES</H3>

</A>
<BLOCKQUOTE>
Sample program:
<P>
<PRE>
   program demo_binran
   use M_datapac, only : binran
   implicit none
   real :: x(40), P
   integer :: N, Npar, Iseed
      Iseed=0
      P=0.88
      N=size(x)
      Npar=11111
      call BINRAN(N,P,Npar,Iseed,X)
      write(*,*)X
   end program demo_binran
<P>
</PRE>
Results:
<P>
<PRE>
      9746.000       9795.000       9855.000       9805.000       9787.000
      9746.000       9764.000       9774.000       9767.000       9752.000
      9770.000       9784.000       9821.000       9805.000       9784.000
      9734.000       9805.000       9813.000       9792.000       9785.000
      9784.000       9815.000       9785.000       9748.000       9718.000
      9728.000       9824.000       9782.000       9776.000       9850.000
      9770.000       9821.000       9819.000       9724.000       9783.000
      9789.000       9813.000       9798.000       9747.000       9785.000
<P>
</PRE>
</BLOCKQUOTE>
<A name=7>

     <H3>AUTHOR</H3>

</A>
<BLOCKQUOTE>
The original DATAPAC library was written by James Filliben of the
Statistical Engineering Division, National Institute of Standards
and Technology.
</BLOCKQUOTE>
<A name=8>

     <H3>MAINTAINER</H3>

</A>
<BLOCKQUOTE>
John Urban, 2022.05.31
</BLOCKQUOTE>
<A name=9>

     <H3>LICENSE</H3>

</A>
<BLOCKQUOTE>
CC0-1.0
</BLOCKQUOTE>
<A name=10>

     <H3>REFERENCES</H3>

</A>
<BLOCKQUOTE>
<TABLE cellpadding=3>
<TR valign=top><TD width=3%>
o
</TD><TD>
Johnson and Kotz, Discrete Distributions, 1969, pages 50-86.
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
Hastings and Peacock, Statistical Distributions,
A Handbook for Students and Practitioners, 1975,
page 41.
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
Feller, An Introduction to Probability Theory and Its Applications,
Volume 1, Edition 2, 1957, pages 135-142.
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
National Bureau of Standards Applied Mathematics
Series 55, 1964, page 929.
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
Kendall and Stuart, The Advanced Theory of Statistics,
Volume 1, Edition 2, 1963, pages 120-125.
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
Mood and Grable, Introduction to the Theory of Statistics,
Edition 2, 1963, pages 64-69.
</TD></TR>
<TR valign=top><TD width=3%>
o
</TD><TD>
Tocher, The Art Of Simulation, 1963, pages 39-40.
</TD></TR>
<TR></TR></TABLE></BLOCKQUOTE>
<P><HR>
<TABLE width=100%><TR> <TD width=33%><I>Nemo Release 3.1</I></TD> <TD width=33% align=center>binran (3)</TD> <TD align=right width=33%><I>July 22, 2023</I></TD> </TR></TABLE><FONT SIZE=-1>Generated by <A HREF="http://www.squarebox.co.uk/download/manServer.shtml">manServer 1.08</A> from 78e6fadf-f79e-48e9-8471-d0a4b624c222 using man macros.</FONT>
<br><br><center><img src="images/binran.3m_datapac.gif"></center>
</div>
</div>
</body>
</HTML>
